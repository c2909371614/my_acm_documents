define("acm/nowcoder/1.0.177/javascripts-acm/component/popupSub/popupEvaluateProblem",["nc","cpn","ncpc","../../action/problem","../../component/star"],function(t,a,e){var n=t("nc"),o=t("cpn"),l=t("ncpc"),i=(n.$,n.Component),r=n.Clazz,c=n.Base,s=n.Str,p=o.Popup,g=l.TagInput,d=e.exports=r.create(),u=t("../../action/problem"),m=t("../../component/star");function f(t,a,e){var n=this;if(n.rawConfig&&n.rawConfig.tagRate)return n.rawConfig.tagRate.handleTag=o(n.rawConfig.tagRate.allTagArray),n.rawConfig.tagRate.handleCommonTag=o(n.rawConfig.tagRate.recommendTags),n.tagData=n.rawConfig.tagRate,void(a&&a(n.tagData));function o(t){return c.map(t,function(t){return{text:t.name,value:c.id(t.id)}})||[]}u.getTagRate({query:{problemId:t.problemId,batch:t.batch,submissionId:t.submissionId,contestId:t.contestId},call:function(t){t.data.handleTag=o(t.data.allTagArray),t.data.handleCommonTag=o(t.data.recommendTags),n.tagData=t.data,a&&a(t.data)},error:function(t){e?e():n.getEl().html('<div style="text-align:center;font-size:14px;">'+t.msg+"</div>")}})}r.mix(d,i,{_template:'<div class="pop-challenge"></div>',listeners:[{name:"render",type:"custom",handler:function(){var a=this;a.getTagRate(a.rawConfig,function(t){a.initContent(t),a.initCpns(t),!t.nextProblemId&&a.popup&&a.popup.okBtn.html("确定"),a.popup&&a.popup.fixPosition()})}}],show:function v(t){var a=new d(t=t||{}),e=p.wrap(a,{title:"恭喜通过本题",width:630,content:a.html(),cancelTxt:"关闭",okTxt:"下一题",ok:function(){return a.check()&&a.submit(function(){if(!a.tagData.nextProblemId)return a.fire("end"),void e.close();a.fire("nextProblem",a.tagData.nextProblemId),e.close()}),!0}});return a},ifShow:function h(a){this.getTagRate(a,function(t){a.call&&a.call(t.show,t)},function(){a.call&&a.call(!1)})},getTagRate:f},{initContent:function b(t){var a=this.rawConfig,e=s.execTpl(['<img src="//static.nowcoder.com/fe/style/images/common/res/tips/7.png" alt="图片">','<div class="pop-challenge-tips">恭喜你AC本题！</div>','<div class="pop-evaluate-topic">',"<p>评价一下题目吧~</p>",'<div class="pop-evaluate-detail" style="padding-bottom:10px;">','<div class="form-group">','<label class="control-label">题目</label>','<div class="control-group">','<a href="/acm/problem/#{problemId}" target="_blank" class="link-green">#{problemName}</a>',"</div>","</div>",'<div class="form-group">','<label class="control-label">题目难度</label>','<div class="control-group js-difficulty"></div>',"</div>",'<div class="form-group">','<label class="control-label">题目知识点</label>','<div class="control-group js-tag"></div>',"</div>"].join(""),{problemName:t.problemName,contestId:a.contestId,problemId:a.problemId});this.getEl().html(e)},initCpns:function C(o){var t=this;t.starCpn=new m({renderTo:t.getEl(".js-difficulty"),scoreDesc:["太简单了","比较简单","不难","难度适中","特别难"]}),t.tagInput=new g({renderTo:t.getEl(".js-tag"),noCustom:!0,width:300,common:o.handleCommonTag,attach:{verReverse:!0},placeholder:"不清楚可以不填写哦~",getSuggest:function(t,a){var e=o.handleTag;if(t){var n=s.searchRegExp(t);e=c.filter(e,function(t){return n.exec(t.text)})}a(e)}}),t.tagInput.getEl(".tags-input-wrap").css("background","#fff").css("width","278px"),t.tagInput.getEl(".tags-input-cont").css("line-height","25px"),t.tagInput.getEl("input").css("height","12px"),t.tagInput.getEl(".tag-label").css("margin-top","5px")},val:function I(t){var a=this;if(0===arguments.length)return{tags:a.tagInput.val(),difficulty:a.starCpn.val().starCount};t=t||{},a.tagInput.val((t.tags||"").split(",")),a.starCpn.val(+t.difficulty||0)},check:function w(){return!!this.val().difficulty||(p.alert("请选择题目难度"),!1)},submit:function T(a){var t=this.rawConfig,e=this.val();u.makeTagRate({type:"POST",body:{problemId:t.problemId,tags:(e.tags||[]).join(","),difficulty:e.difficulty},call:function(t){a&&a()},error:function(t){p.alert(t.msg)}})},getTagRate:f})});